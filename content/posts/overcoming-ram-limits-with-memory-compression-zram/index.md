---
title: "zram 메모리 압축으로 RAM 한계 극복"
date: 2025-05-02T12:12:58+09:00
draft: false
description: "zram을 사용한 메모리 압축과 성능 향상 방법을 다룬다."
tags: ["Linux", "메모리", "성능"]
---

## zram의 개념과 원리

zram(이전 명칭: compcache)은 리눅스 커널에서 제공하는 메모리 압축 기술로, RAM의 일부를 압축하여 가상 블록 장치로 사용하는 메커니즘이며, 이 기술은 2009년 Nitin Gupta에 의해 처음 개발되었고 리눅스 커널 3.14부터 정식으로 통합되어 현재까지 널리 사용되고 있다. zram의 핵심 아이디어는 디스크 기반 스왑 대신 압축된 RAM을 스왑 공간으로 활용함으로써 디스크 I/O의 부하 없이 메모리 사용량을 효과적으로 줄이는 것이며, 특히 메모리가 제한된 환경에서 시스템 성능을 크게 향상시킬 수 있다.

zram 장치는 데이터를 메모리에 저장하기 전에 실시간으로 압축하고 데이터 접근 시 실시간으로 압축을 해제하며, 이 과정에서 CPU 리소스를 일부 소모하지만 디스크 I/O를 완전히 피할 수 있어 전체적인 시스템 성능 향상에 크게 기여한다. 일반적으로 zram은 LZO(Lempel-Ziv-Oberhumer), LZ4, ZSTD(Zstandard)와 같은 고속 압축 알고리즘을 사용하여 2:1에서 4:1 정도의 압축률을 달성하며, 압축 알고리즘은 시스템 요구사항에 따라 선택할 수 있고 Ubuntu 24.04에서는 기본적으로 속도와 압축률의 균형이 우수한 LZ4 알고리즘을 사용한다.

## zram의 주요 장점

### 메모리 용량 확장

zram의 가장 큰 장점은 물리적인 메모리 확장 없이도 가용 메모리를 효과적으로 늘릴 수 있다는 점이며, 텍스트 데이터가 많은 환경에서는 최대 4배까지 압축률을 달성할 수 있고 평균적으로도 약 2배의 압축률을 보이므로, 8GB RAM 시스템에서 실질적으로 12-16GB 정도의 메모리 효과를 볼 수 있어 추가 하드웨어 투자 없이 시스템 성능을 향상시킬 수 있다.

### 시스템 응답성 향상

디스크 기반 스왑은 접근 속도가 느려 시스템 응답성을 크게 저하시키며 특히 HDD의 경우 수십 밀리초의 지연이 발생하는 반면, zram은 RAM 내에서 작동하므로 디스크 스왑보다 수백 배 빠른 속도로 데이터에 접근할 수 있고 마이크로초 단위의 지연만 발생하여 메모리 부족 상황에서도 시스템 응답성을 유지하는 데 큰 도움이 된다. 특히 저사양 시스템이나 메모리가 제한된 환경, 그리고 웹 브라우저나 IDE처럼 메모리 사용량이 많은 애플리케이션을 실행하는 환경에서 더욱 효과적이다.

### 디스크 수명 연장

SSD와 같은 저장 장치는 쓰기 횟수에 제한이 있어 스왑 사용이 많을수록 디스크 수명이 단축되며, 일반적인 SSD는 수십~수백 TBW(Terabytes Written)의 수명을 가지고 있어 과도한 스왑 사용은 수명 단축의 주요 원인이 된다. zram은 디스크 기반 스왑 사용을 줄여 저장 장치의 수명을 연장하는 효과가 있으며, 특히 임베디드 시스템이나 저가형 SSD를 사용하는 환경, 그리고 서버처럼 24시간 가동되는 시스템에서 중요한 이점을 제공한다.

### 전력 효율성

모바일 기기나 노트북에서는 디스크 I/O가 많을수록 전력 소모가 증가하며, 특히 HDD의 경우 물리적인 헤드 이동과 플래터 회전으로 인해 상당한 전력을 소비하고 SSD도 쓰기 작업 시 일정한 전력을 사용한다. zram은 디스크 접근을 줄여 배터리 수명을 연장하는 데 도움을 주며, 비록 압축과 해제 과정에서 CPU를 사용하지만 현대 프로세서의 효율적인 압축 명령어와 낮은 CPU 전력 소비로 인해 디스크 I/O 절감 효과가 훨씬 크므로 전체적인 전력 효율성이 향상된다.

## Ubuntu 24.04에서의 zram 간편 설치 및 사용

Ubuntu 24.04에서는 zram을 설치하고 바로 사용하는 방법이 매우 간단하며, Ubuntu 개발팀이 일반 사용자를 위해 사전 구성된 패키지를 제공하므로 복잡한 커널 모듈 설정이나 스크립트 작성 없이 단 한 번의 명령어로 설치하면 자동으로 설정되어 즉시 사용할 수 있다.

```bash
sudo apt install zram-config
```

이 명령어로 zram-config 패키지를 설치하면 시스템이 자동으로 zram을 설정하고 활성화하며, 부팅 시 자동으로 시작되도록 systemd 서비스를 등록하고 최적의 기본 설정을 적용하므로 별도의 재부팅이나 추가 설정 없이도 즉시 효과를 체감할 수 있다.

### 기본 설정

Ubuntu 24.04에서 zram-config 패키지를 설치하면 다음과 같은 기본 설정이 자동으로 적용되며, 이 설정들은 Ubuntu 개발팀이 다양한 테스트와 벤치마크를 통해 최적화한 값이다.

-   RAM의 약 50%를 zram 크기로 설정하여 물리 메모리와 압축 메모리 간의 균형을 유지한다
-   압축 알고리즘은 효율적인 LZ4를 사용하여 빠른 압축과 해제 속도를 보장한다
-   스왑 우선순위를 100으로 설정하여 디스크 스왑(기본 우선순위 -2)보다 우선적으로 사용되도록 한다
-   시스템 부팅 시 자동으로 활성화되어 사용자의 별도 개입 없이 지속적으로 작동한다

이 기본 설정은 대부분의 사용자에게 적합하며 일반적인 데스크톱 워크로드에서 별도의 추가 조정 없이도 즉시 성능 향상 효과를 볼 수 있다.

### 설치 확인

설치 후 zram이 정상적으로 작동하는지 확인하려면 다음 명령어를 사용하면 된다:

```bash
zramctl
```

또는

```bash
swapon --show
```

출력 결과에 `/dev/zram0`가 표시되면 zram이 정상적으로 설치되고 활성화된 것이다.

## zram 사용 시 고려사항

대부분의 일반적인 사용 환경에서 기본 설정으로도 충분한 성능 향상을 볼 수 있으며, 특히 웹 브라우징, 문서 편집, 코드 개발과 같은 일반적인 워크로드에서 효과적이다. 매우 메모리 집약적인 응용 프로그램을 사용하거나 여러 개의 가상 머신을 실행하는 환경에서는 더 큰 성능 향상을 체감할 수 있다.

**하이버네이션과 zram**: 하이버네이션(절전 모드)이 필요한 경우 zram 대신 zswap 사용을 고려해야 하며, 이는 zram이 순수 메모리 기반이라 전원이 꺼지면 데이터가 사라지는 반면 zswap은 디스크 스왑과 함께 작동하여 하이버네이션을 지원하기 때문이다. zswap은 메모리 압축 캐시 역할을 하며 압축된 데이터를 RAM에 저장하되 필요시 디스크로 내보낼 수 있어, zram과 디스크 스왑의 중간 형태로 볼 수 있다.

**메모리 용량별 효과**: 메모리가 매우 충분한 시스템(32GB 이상)에서는 zram의 효과가 제한적일 수 있으며, 스왑이 거의 사용되지 않는 환경에서는 zram을 활성화해도 성능 향상을 체감하기 어렵다. 반면 8GB 이하의 메모리를 가진 시스템이나 다수의 브라우저 탭을 열어두는 사용 패턴에서는 zram의 효과가 매우 크다.

**CPU 부하 고려**: CPU 부하가 이미 높은 환경에서는 압축과 해제 과정에서 추가 부하가 발생할 수 있으나, 현대 프로세서는 매우 효율적인 압축 성능을 제공하므로 대부분의 경우 CPU 오버헤드는 1-3% 수준에 불과하며 디스크 I/O 대기 시간 감소 효과가 훨씬 크다.

## 결론

Ubuntu 24.04에서 zram은 단 한 번의 설치 명령으로 즉시 활용할 수 있는 강력한 메모리 최적화 기술이며, 2009년 개발 이후 15년 이상의 검증된 안정성과 효율성을 자랑한다. 특히 메모리가 제한된 시스템에서 성능을 크게 향상시킬 수 있고, 디스크 수명 연장과 전력 효율성 측면에서도 실질적인 장점을 제공하며, Ubuntu가 제공하는 사전 구성된 패키지 덕분에 기본 설정만으로도 충분한 효과를 얻을 수 있어 일반 사용자에게 매우 유용한 도구이다.

메모리 부족 현상을 겪고 있거나 시스템 응답성 향상을 원하는 Ubuntu 24.04 사용자라면 zram-config 패키지 설치만으로도 즉각적인 개선 효과를 체감할 수 있으며, 특히 8GB 이하의 RAM을 가진 시스템이나 다수의 애플리케이션을 동시에 실행하는 환경에서 그 효과가 두드러진다.
