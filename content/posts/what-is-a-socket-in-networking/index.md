---
title: "socket이란 무엇인가?"
date: 2024-06-08T21:22:40+09:00
tags: ["network", "socket"]
description: "1983년 Berkeley Sockets의 역사, TCP 소켓과 UDP 소켓의 상세 비교, 소켓 프로그래밍 과정(socket, bind, listen, accept, connect), 클라이언트-서버 아키텍처, WebSocket과의 차이까지 정리"
draft: false
---

## 소켓의 역사

소켓은 버클리 대학에서 만들어져 1983년에 출시된 4.2BSD 유닉스 운영 체제에서 시작되었다.

### Berkeley Socket의 탄생

버클리 소켓(Berkeley socket) 또는 BSD 소켓은 프로세스 간 통신(IPC)에 사용되는 인터넷 도메인 소켓 및 유닉스 도메인 소켓용 API이다.

- **1982년**: BSD UNIX 4.1에서 처음 소개
- **1986년**: BSD UNIX 4.3에서 개정된 버전이 현재 널리 사용됨
- 사실상 표준에서 POSIX 사양의 구성 요소로 거의 수정되지 않은 채 발전

## 소켓이란

소켓은 네트워크 통신을 위한 인터페이스를 제공하는 소프트웨어이다. 클라이언트와 서버 간의 통신을 가능하게 하며 데이터를 주고받을 수 있다.

### 소켓의 기능

- 네트워크 통신을 위한 API를 제공
- TCP와 UDP를 지원
- 네트워크 상에서 두 노드를 연결하여 통신

### 통신 방식

한 소켓은 특정 IP의 특정 포트에서 수신 대기하고 다른 소켓은 연결을 형성하기 위해 상대방에게 접근한다.

## TCP 소켓과 UDP 소켓의 상세 비교

TCP와 UDP는 TCP/IP의 전송계층에서 사용되는 프로토콜이다. 전송계층은 IP에 의해 전달되는 패킷의 오류를 검사하고 재전송 요구 등의 제어를 담당하는 계층이다.

### TCP 소켓

TCP는 연결형, 신뢰성 전송 프로토콜이다.

#### 연결 지향적 서비스

- 데이터를 전송하기 전에 3-way handshaking을 수행
- 두 호스트의 전송 계층 사이에 논리적 연결을 설립
- TCP 통신은 connection setup, data transfer, connection termination의 세 단계로 나뉨

#### 신뢰성 보장 메커니즘

- **오류제어**: 훼손된 segment의 감지 및 재전송, 손실된 segment의 재전송
- **순서 보장**: 순서가 맞지 않게 도착한 segment를 정렬하고 중복 segment 감지 및 폐기
- **흐름제어**: 수신측이 처리할 수 있는 속도로 데이터 전송
- **혼잡제어**: 네트워크 혼잡을 감지하고 전송 속도 조절

#### 특징

- 헤더 크기: 20바이트
- 데이터 전송 단위: 세그먼트
- 속도: 비교적 느림 (신뢰성 보장으로 인한 오버헤드)

#### 사용 사례

- 신뢰성이 중요한 통신(HTTP, File 전송 등)
- 데이터의 순서와 신뢰성이 중요한 금융 거래 시스템
- 데이터베이스 관리 시스템

### UDP 소켓

UDP는 비연결형, 비신뢰성 전송 프로토콜이다.

#### 비연결형 특성

- 3-way handshake 등의 세션 수립 과정이 없음
- 연결 설정과 종료 과정이 없음

#### 비신뢰성 특성

- 흐름제어, 오류제어, 혼잡 제어를 제공하지 않음
- 수신 여부를 확인하지 않음

#### 특징

- 헤더 크기: 8바이트 (적은 오버헤드)
- 데이터 전송 단위: 메시지
- 속도: 빠름 (단순성 덕분)

#### 사용 사례

- 실시간성이 중요한 통신(동영상 스트리밍 등)
- 도메인 이름 서비스(DNS)
- IPTV, 음성 인터넷 프로토콜(VoIP)
- 비디오 스트리밍
- 온라인 게임

## 소켓 프로그래밍 과정

소켓 프로그래밍의 주요 함수로는 socket, bind, listen, accept, connect가 있다.

### socket()

소켓을 생성하는 초기 단계로 클라이언트와 서버 모두에서 사용된다.

- 소켓 객체를 생성하고 파일 디스크립터를 반환
- 프로토콜(TCP 또는 UDP)을 지정

### bind()

소켓에 로컬 프로토콜 주소를 할당한다.

- 인터넷 프로토콜에서는 IPv4 또는 IPv6 주소와 16비트 TCP 포트 번호의 조합을 의미
- 일반적으로 서버 측에서 사용
- 소켓을 소켓 주소 구조, 즉 지정된 로컬 IP 주소와 포트 번호에 연결

### listen()

연결되지 않은 소켓을 수동 소켓으로 변환한다.

- 커널이 이 소켓으로 향하는 수신 연결 요청을 수락해야 함을 나타냄
- 서버 측에서 사용
- 바인드된 TCP 소켓이 수신 대기 상태로 전환

### accept()

서버 측에서 사용되며 원격 클라이언트로부터 받은 새로운 TCP 연결 생성 시도를 수락한다.

- 이 연결의 소켓 주소 쌍과 연결된 새 소켓 객체를 생성
- 실행을 차단하고 수신 연결을 기다림
- 클라이언트가 연결되면 연결을 나타내는 새 소켓 객체와 클라이언트의 주소를 보유한 튜플을 반환

### connect()

클라이언트 측에서 사용되며 소켓에 사용 가능한 로컬 포트 번호를 할당한다.

- TCP 소켓의 경우 새로운 TCP 연결 설정을 시도
- 클라이언트는 일반적으로 연결을 시작하기 전에 명시적인 바인드 작업을 수행하지 않음
- 서비스 제공자가 대신 암시적 바인드를 수행하도록 허용

### 일반적인 흐름

#### 서버

socket() → bind() → listen() → accept() → send/recv → close()

#### 클라이언트

socket() → connect() → send/recv → close()

## 클라이언트-서버 아키텍처

클라이언트-서버 아키텍처는 리소스 또는 서비스 제공자(서버)와 서비스 요청자(클라이언트) 간에 작업 또는 워크로드를 분할하는 분산 애플리케이션 구조이다.

### 구성 요소

- **클라이언트**: 네트워크에서 서비스를 요청
- **서버**: 이러한 서비스를 제공

### 통신 방식

클라이언트와 서버는 종종 컴퓨터 네트워크를 통해 별도의 하드웨어에서 통신하지만 클라이언트와 서버가 모두 같은 장치에 있을 수도 있다.

- 클라이언트는 서버와의 통신 세션을 시작
- 서버는 수신 요청을 기다림

### 사용 예시

클라이언트-서버 모델을 사용하는 컴퓨터 애플리케이션은 다음과 같다.

- 이메일
- 네트워크 인쇄
- 월드 와이드 웹
- 소셜 미디어 플랫폼
- 온라인 쇼핑몰
- 콘텐츠 관리 시스템(CMS)

### 장점

- **중앙 집중화**: 데이터와 리소스의 중앙 집중화를 통해 데이터 관리와 보안을 강화
- **다양한 클라이언트 지원**: 다양한 클라이언트 장치에서 서비스를 사용할 수 있게 함
- **유지보수성**: 서버와 클라이언트가 분리되어 독립적으로 개발 및 업데이트 가능
- **확장성**: 시스템 확장성과 유지보수성이 향상

## WebSocket과의 차이

### OSI 계층 차이

OSI 7계층 기준으로 다음과 같이 구분된다.

- **소켓**: 인터넷 프로토콜에 기반하므로 TCP, UDP가 속한 4계층에 위치
- **웹소켓**: TCP에 의존하지만 HTTP에 기반하므로 7계층에 위치

웹소켓은 HTTP 레이어에서 작동하는 소켓으로 TCP/IP 소켓과는 레이어가 다르다.

### TCP 소켓의 특징

- 신뢰성 있는 연결 지향형 프로토콜
- 양방향 데이터 스트림을 제공
- 주로 서버와 클라이언트 간의 연결을 설정하고 데이터를 안정적으로 교환하기 위해 사용

### WebSocket의 특징

HTML5에서 도입된 양방향 통신 프로토콜로 웹 애플리케이션과 서버 간의 실시간 통신을 위해 설계되었다.

#### 주요 특징

- 단일 TCP 연결로 동시 양방향 통신 채널을 제공하는 컴퓨터 통신 프로토콜
- HTTP 포트 80과 443 위에 동작하도록 설계
- HTTP 프록시 및 중간 층을 지원하도록 설계되었으므로 HTTP 프로토콜과 호환

### 관계

한마디로 웹소켓은 TCP 소켓과 구분되는 것이 아니라 TCP 소켓의 추상화된 형태이다. 소켓 통신에 기반하여 웹 애플리케이션에 맞게 발전한 형태로 소켓 통신을 한다.

실제로 실시간 양방향 통신이 가능한 웹소켓은 2011년 국제 인터넷 표준화 기구(IETF)에서 RFC 6455로 표준화되었다.

## 결론

소켓은 1983년 Berkeley Sockets로 시작되어 프로세스 간 통신을 위한 API로 발전했다. 네트워크 통신을 위한 인터페이스를 제공하여 클라이언트와 서버 간의 통신을 가능하게 한다.

TCP 소켓은 연결 지향적이고 신뢰성 있는 통신을 제공한다. 3-way handshaking, 오류제어, 흐름제어, 혼잡제어를 수행하여 HTTP나 파일 전송 같은 신뢰성이 중요한 서비스에 사용된다.

UDP 소켓은 비연결형이고 빠른 속도를 제공한다. DNS, 스트리밍, 온라인 게임 같은 실시간성이 중요한 서비스에 사용된다.

소켓 프로그래밍은 socket, bind, listen, accept, connect 함수를 통해 이루어진다. 서버와 클라이언트가 각각 정해진 순서로 함수를 호출하여 통신을 수행한다.

클라이언트-서버 아키텍처는 데이터 중앙 집중화와 독립적인 개발을 가능하게 한다. WebSocket은 TCP 소켓을 기반으로 하여 HTTP 레이어에서 작동하는 애플리케이션 계층 프로토콜로, 2011년 RFC 6455로 표준화되어 웹 환경에서 실시간 양방향 통신을 쉽게 구현할 수 있도록 만들어졌다.
